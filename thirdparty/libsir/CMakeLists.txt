CMAKE_MINIMUM_REQUIRED(VERSION 2.8)

SET(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib)
SET(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib)
SET(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin)

SET(CMAKE_C_STANDARD 11)
SET(CMAKE_C_STANDARD_REQUIRED ON)
SET(CMAKE_C_FLAGS "-std=gnu11")
SET(CMAKE_C_EXTENSIONS ON)

SET(CMAKE_CXX_STANDARD 11)
SET(CMAKE_CXX_STANDARD_REQUIRED ON)
SET(CMAKE_CXX_FLAGS "-std=gnu++11")
SET(CMAKE_CXX_EXTENSIONS ON)

SET(CMAKE_BUILD_TYPE DEBUG)

SET(COMMON_FLAGS "-fstack-protector-strong -Wl,-z,relro \
                  -Os -Wall -fno-strict-aliasing -g -rdynamic")

SET(CMAKE_C_FLAGS ${COMMON_FLAGS})
SET(CMAKE_C_FLAGS_DEBUG ${COMMON_FLAGS})
SET(CMAKE_C_FLAGS_RELEASE ${COMMON_FLAGS})

SET(CMAKE_CXX_FLAGS ${COMMON_FLAGS})
SET(CMAKE_CXX_FLAGS_DEBUG ${COMMON_FLAGS})
SET(CMAKE_CXX_FLAGS_RELEASE ${COMMON_FLAGS})


INCLUDE_DIRECTORIES(inc)


LINK_LIBRARIES(-lpthread -lm)

SET(CMAKE_EXE_LINKER_FLAGS "-g -rdynamic")

AUX_SOURCE_DIRECTORY(./ MAIN_DIR_SRCS)


ADD_LIBRARY(logger SHARED ${MAIN_DIR_SRCS})
ADD_LIBRARY(logger_static STATIC ${MAIN_DIR_SRCS})
SET_TARGET_PROPERTIES(logger PROPERTIES VERSION 1.2 SOVERSION 1)
INSTALL(TARGETS logger logger_static LIBRARY DESTINATION lib ARCHIVE DESTINATION lib)
